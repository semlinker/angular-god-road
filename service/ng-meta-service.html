<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Meta 标签 | Angular 修仙之路</title>
    <meta name="description" content="修炼 Angular、RxJS、TypeScript 秘籍">
    
    
    <link rel="preload" href="/angular-god-road/assets/css/styles.4eaf616f.css" as="style"><link rel="preload" href="/angular-god-road/assets/js/app.4eaf616f.js" as="script"><link rel="preload" href="/angular-god-road/assets/js/35.284fb844.js" as="script"><link rel="prefetch" href="/angular-god-road/assets/css/1.styles.24fddc56.css"><link rel="prefetch" href="/angular-god-road/assets/css/2.styles.a2bd3099.css"><link rel="prefetch" href="/angular-god-road/assets/js/1.24fddc56.js"><link rel="prefetch" href="/angular-god-road/assets/js/10.edd26f16.js"><link rel="prefetch" href="/angular-god-road/assets/js/11.33f54712.js"><link rel="prefetch" href="/angular-god-road/assets/js/12.fcc87fd4.js"><link rel="prefetch" href="/angular-god-road/assets/js/13.fa6e9f88.js"><link rel="prefetch" href="/angular-god-road/assets/js/14.050d9df1.js"><link rel="prefetch" href="/angular-god-road/assets/js/15.9f880834.js"><link rel="prefetch" href="/angular-god-road/assets/js/16.b96760bb.js"><link rel="prefetch" href="/angular-god-road/assets/js/17.13fefc8b.js"><link rel="prefetch" href="/angular-god-road/assets/js/18.c850d375.js"><link rel="prefetch" href="/angular-god-road/assets/js/19.7239064a.js"><link rel="prefetch" href="/angular-god-road/assets/js/2.a2bd3099.js"><link rel="prefetch" href="/angular-god-road/assets/js/20.4125efb9.js"><link rel="prefetch" href="/angular-god-road/assets/js/21.2a9e4d33.js"><link rel="prefetch" href="/angular-god-road/assets/js/22.f2cf7fbc.js"><link rel="prefetch" href="/angular-god-road/assets/js/23.7ff8e04e.js"><link rel="prefetch" href="/angular-god-road/assets/js/24.9f44b1b7.js"><link rel="prefetch" href="/angular-god-road/assets/js/25.0ec2854a.js"><link rel="prefetch" href="/angular-god-road/assets/js/26.7c66210d.js"><link rel="prefetch" href="/angular-god-road/assets/js/27.d9097f9d.js"><link rel="prefetch" href="/angular-god-road/assets/js/28.7d96a001.js"><link rel="prefetch" href="/angular-god-road/assets/js/29.4fc02651.js"><link rel="prefetch" href="/angular-god-road/assets/js/3.3d49ed81.js"><link rel="prefetch" href="/angular-god-road/assets/js/30.99a6671a.js"><link rel="prefetch" href="/angular-god-road/assets/js/31.2591ba92.js"><link rel="prefetch" href="/angular-god-road/assets/js/32.78ddd0be.js"><link rel="prefetch" href="/angular-god-road/assets/js/33.e9af0299.js"><link rel="prefetch" href="/angular-god-road/assets/js/34.c0d5a741.js"><link rel="prefetch" href="/angular-god-road/assets/js/36.1cb64f86.js"><link rel="prefetch" href="/angular-god-road/assets/js/37.b69ebefc.js"><link rel="prefetch" href="/angular-god-road/assets/js/38.048dd2ef.js"><link rel="prefetch" href="/angular-god-road/assets/js/39.9e4eec87.js"><link rel="prefetch" href="/angular-god-road/assets/js/4.ff267ab9.js"><link rel="prefetch" href="/angular-god-road/assets/js/40.9610211f.js"><link rel="prefetch" href="/angular-god-road/assets/js/41.ddd45347.js"><link rel="prefetch" href="/angular-god-road/assets/js/42.d2ebe819.js"><link rel="prefetch" href="/angular-god-road/assets/js/43.e1f5311e.js"><link rel="prefetch" href="/angular-god-road/assets/js/44.b5c3267a.js"><link rel="prefetch" href="/angular-god-road/assets/js/45.b34d49e9.js"><link rel="prefetch" href="/angular-god-road/assets/js/46.3602c3b6.js"><link rel="prefetch" href="/angular-god-road/assets/js/5.488dbe6d.js"><link rel="prefetch" href="/angular-god-road/assets/js/6.1c8c7528.js"><link rel="prefetch" href="/angular-god-road/assets/js/7.fc1d55b7.js"><link rel="prefetch" href="/angular-god-road/assets/js/8.0ebf2d9c.js"><link rel="prefetch" href="/angular-god-road/assets/js/9.dacb7e8b.js">
    <link rel="stylesheet" href="/angular-god-road/assets/css/1.styles.24fddc56.css"><link rel="stylesheet" href="/angular-god-road/assets/css/2.styles.a2bd3099.css"><link rel="stylesheet" href="/angular-god-road/assets/css/styles.4eaf616f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/angular-god-road/" class="home-link router-link-active"><!----> <span class="site-name">Angular 修仙之路</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/angular-god-road/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://semlinker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端修仙之路
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/semlinker" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/angular-god-road/" class="nav-link">首页</a></div><div class="nav-item"><a href="https://semlinker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端修仙之路
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/semlinker" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>入门篇</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/angular-god-road/quickstart/ng-quickstart.html" class="sidebar-link">Angular 6 快速入门</a></li><li><a href="/angular-god-road/quickstart/ng-base-tutorial.html" class="sidebar-link">Angular 6 基础教程</a></li><li><a href="/angular-god-road/quickstart/ng-pipe-quickstart.html" class="sidebar-link">Angular 6 管道快速入门</a></li><li><a href="/angular-god-road/quickstart/ng-form-quickstart.html" class="sidebar-link">Angular 6 表单快速入门</a></li><li><a href="/angular-god-road/quickstart/ng-directive-quickstart.html" class="sidebar-link">Angular 6 快速入门</a></li><li><a href="/angular-god-road/quickstart/ng-http-client-quickstart.html" class="sidebar-link">Angular 6 HttpClient 快速入门</a></li><li><a href="/angular-god-road/quickstart/ng-library-quickstart.html" class="sidebar-link">Angular Library 快速入门</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>工具篇</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>元素篇</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>其它</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>RxJS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>RxJS</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h3 id="meta-标签"><a href="#meta-标签" aria-hidden="true" class="header-anchor">#</a> Meta 标签</h3> <blockquote><p>The </p><meta> tag provides metadata about the HTML document. Metadata will not be displayed on the page, but will be machine parsable.<p></p></blockquote> <p>Metadata 中文名叫元数据，是用于描述数据的数据。它不会显示在页面上，但是机器却可以识别。meta 常用于定义页面的说明，关键字，最后修改日期，和其它的元数据。这些元数据将服务于浏览器，搜索引擎和其它网络服务。</p> <p>meta 标签共有两个属性，分别是 name 属性和 http-equiv 属性：</p> <ul><li>name：主要用于描述网页，比如网页的关键词，网站描述等。与之对应的属性值为 content，content 中的内容是对 name 填入类型的具体描述，便于搜索引擎抓取。比如我们常见的 viewport：</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width,initial-scale=1,maximum-scale=1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>http-equiv：相当于文件的头作用，用于向浏览器传递一些有用的信息，以帮助正确地显示网页内容，与之对应的属性为 content。</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>以上代码告诉 IE 浏览器，IE8/9 及以后的版本都会以最高版本 IE 来渲染页面。关于 HTML meta 标签的相关知识，这里就不再继续展开，感兴趣的同学可以阅读 <a href="https://segmentfault.com/a/1190000004279791" target="_blank" rel="noopener noreferrer">HTML meta标签总结与属性使用介绍<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这篇文章。</p> <h3 id="meta-service-简介"><a href="#meta-service-简介" aria-hidden="true" class="header-anchor">#</a> Meta Service 简介</h3> <p>为了让开发者能够方便地操作页面中的 Meta 信息，Angular 为我们提供 Meta 服务。该服务支持以下的方法：</p> <ul><li><a href="https://angular.io/api/platform-browser/Meta#addTag" target="_blank" rel="noopener noreferrer">addTag<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://angular.io/api/platform-browser/Meta#addTags" target="_blank" rel="noopener noreferrer">addTags<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://angular.io/api/platform-browser/Meta#getTag" target="_blank" rel="noopener noreferrer">getTag<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://angular.io/api/platform-browser/Meta#getTags" target="_blank" rel="noopener noreferrer">getTags<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://angular.io/api/platform-browser/Meta#updateTag" target="_blank" rel="noopener noreferrer">updateTag<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://angular.io/api/platform-browser/Meta#removeTag" target="_blank" rel="noopener noreferrer">removeTag<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://angular.io/api/platform-browser/Meta#removeTagElement" target="_blank" rel="noopener noreferrer">removeTagElement<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>首先要使用 Meta 服务，我们需要从 <code>@angular/platform-browser</code> 库导入 Meta 类，然后利用 Angular 依赖注入的机制，通过构造注入的方式注入 Meta 服务：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Meta <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser'</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   providedIn<span class="token punctuation">:</span> <span class="token string">'root'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MetaService</span> <span class="token punctuation">{</span> 
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> meta<span class="token punctuation">:</span> Meta<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre></div><h4 id="addtag"><a href="#addtag" aria-hidden="true" class="header-anchor">#</a> addTag()</h4> <blockquote><p><a href="https://angular.io/api/platform-browser/Meta#addTag" target="_blank" rel="noopener noreferrer">addTag(tag: MetaDefinition, forceCreation: boolean = false): HTMLMetaElement | null<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>该方法用于在页面上添加一个 HTML Meta 标签，它接收两个参数：</p> <ul><li>tag：MetaDefinition 类型的对象</li> <li>forceCreation：是否强制创建，默认为 false</li></ul> <p>tag 参数对应的 MetaDefinition 类型定义如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">type</span> MetaDefinition <span class="token operator">=</span> <span class="token punctuation">{</span>
  charset<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> 
  content<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  httpEquiv<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> 
  id<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> 
  itemprop<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  property<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  scheme<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  url<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token operator">&amp;</span>
<span class="token punctuation">{</span>
  <span class="token comment">// TODO(IgorMinar): this type looks wrong</span>
  <span class="token punctuation">[</span>prop<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>了解完上述的内容，我们来动手实践一下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  providedIn<span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MetaService</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> meta<span class="token punctuation">:</span> Meta<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

  <span class="token function">addTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">addTag</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'description'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token string">'Angular Meta Service'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">addTag</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token string">'Angular, RxJS, TypeScript'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上述代码我们通过调用 meta 服务的 <code>addTag()</code> 方法，创建了两个 Meta 标签。如果需要一次添加多个 meta 标签，我们可以调用 addTags() 方法。</p> <h4 id="addtags"><a href="#addtags" aria-hidden="true" class="header-anchor">#</a> addTags()</h4> <blockquote><p>[addTags(tags: MetaDefinition<a href="https://angular.io/api/platform-browser/Meta#addTags" target="_blank" rel="noopener noreferrer">], forceCreation: boolean = false): HTMLMetaElement[]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>该方法用于一次性添加多个 HTML Meta 标签，它接收两个参数：</p> <ul><li>tags：MetaDefinition 类型的对象数组</li> <li>forceCreation：是否强制创建，默认为 false</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">addTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">addTags</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'description'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token string">'Angular Meta Service'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token string">'Angular, RxJS, TypeScript'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在创建完 HTML meta 标签，我们可以通过 getTag() 方法来获取对应的 HTMLMetaElement 对象。</p> <h4 id="gettag"><a href="#gettag" aria-hidden="true" class="header-anchor">#</a> getTag()</h4> <blockquote><p><a href="https://angular.io/api/platform-browser/Meta#getTag" target="_blank" rel="noopener noreferrer">getTag(attrSelector: string): HTMLMetaElement | null<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>该方法用于获取 attrSelector 属性选择器对应的 HTMLMetaElement 对象，它接收一个参数，即属性选择器，比如我们需要获取 <code>keywords</code> meta 标签：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">getMetaTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> metaEl<span class="token punctuation">:</span> HTMLMetaElement <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">getTag</span><span class="token punctuation">(</span><span class="token string">'name=&quot;keywords&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Get keywords meta tag: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>metaEl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当 getTag() 方法匹配不了 attrSelector 属性选择器时，会返回 null 对象。与 setTag() 类似，getTag() 方法也存在一个 getTags() 方法。</p> <h4 id="gettags"><a href="#gettags" aria-hidden="true" class="header-anchor">#</a> getTags()</h4> <blockquote><p><a href="https://angular.io/api/platform-browser/Meta#getTags" target="_blank" rel="noopener noreferrer">getTags(attrSelector: string): HTMLMetaElement[]<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>该方法用于获取所有匹配 attrSelector 选择器的所有 HTMLMetaElement 对象：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">getMetaTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> els<span class="token punctuation">:</span> HTMLMetaElement<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  els<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>el <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时我们已经介绍完了如何创建和查找 HTMLMetaElement 对象，有时候在创建完 HTMLMetaElement 对象后，我们可能需要修改  HTMLMetaElement 对象，此时我们需要使用 updateTag() 方法。</p> <h4 id="updatetag"><a href="#updatetag" aria-hidden="true" class="header-anchor">#</a> updateTag()</h4> <blockquote><p><a href="https://angular.io/api/platform-browser/Meta#updateTag" target="_blank" rel="noopener noreferrer">updateTag(tag: MetaDefinition, selector?: string): HTMLMetaElement | null<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>该方法用于更新 HTML Meta 标签的信息，它接收两个参数：</p> <ul><li>tag：MetaDefinition 类型的对象</li> <li>selector（可选）：选择器</li></ul> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">updateMetaTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">updateTag</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'description'</span><span class="token punctuation">,</span> 
    content<span class="token punctuation">:</span> <span class="token string">'Updated: Angular Meta Service'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">updateTag</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'keywords'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token string">'Node.js, Angular'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>除了更新 HTML Meta 标签之外，我们也可以移除指定的 HTML Meta 标签。</p> <h4 id="removetag"><a href="#removetag" aria-hidden="true" class="header-anchor">#</a> removeTag()</h4> <blockquote><p><a href="https://angular.io/api/platform-browser/Meta#removeTag" target="_blank" rel="noopener noreferrer">removeTag(attrSelector: string): void<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>该方法用于移除匹配 attrSelector 属性选择器的 HTML Meta 标签：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">removeMetaTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">removeTag</span><span class="token punctuation">(</span><span class="token string">'name=&quot;description&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">removeTag</span><span class="token punctuation">(</span><span class="token string">'name=&quot;keywords&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最后我们来介绍 removeTagElement() 方法。</p> <h4 id="removetagelement"><a href="#removetagelement" aria-hidden="true" class="header-anchor">#</a> removeTagElement()</h4> <blockquote><p><a href="https://angular.io/api/platform-browser/Meta#removeTagElement" target="_blank" rel="noopener noreferrer">removeTagElement(meta: HTMLMetaElement): void<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>该方法用于移除 meta 参数对应的 HTML Meta 标签：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">removeTagElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> keywords<span class="token punctuation">:</span> HTMLMetaElement <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">getTag</span><span class="token punctuation">(</span><span class="token string">'name=&quot;keywords&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">removeTagElement</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>感兴趣的同学，可以浏览 <a href="https://stackblitz.com/edit/sm-angular-meta-service" target="_blank" rel="noopener noreferrer">Stackblitz<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 线上示例。下面我们来简单分析一下 Meta Service 的源码。</p> <h3 id="meta-service-源码简析"><a href="#meta-service-源码简析" aria-hidden="true" class="header-anchor">#</a> Meta Service 源码简析</h3> <h4 id="meta-service-类及构造函数"><a href="#meta-service-类及构造函数" aria-hidden="true" class="header-anchor">#</a> Meta Service 类及构造函数</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// packages/platform-browser/src/browser/meta.ts</span>
@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>providedIn<span class="token punctuation">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span> useFactory<span class="token punctuation">:</span> createMeta<span class="token punctuation">,</span> deps<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Meta</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> _dom<span class="token punctuation">:</span> DomAdapter<span class="token punctuation">;</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>@<span class="token function">Inject</span><span class="token punctuation">(</span><span class="token constant">DOCUMENT</span><span class="token punctuation">)</span> <span class="token keyword">private</span> _doc<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
      <span class="token keyword">this</span><span class="token punctuation">.</span>_dom <span class="token operator">=</span> <span class="token function">getDOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取DOM适配器</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过观察 Injectable 装饰器的 Meta 元信息，我们知道 Meta 服务将被注册在根级注入器中，当首次获取 Meta 服务时，将使用 createMeta() 工厂方法创建对应的实例。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Inject<span class="token punctuation">,</span> Injectable<span class="token punctuation">,</span> inject<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createMeta</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Meta</span><span class="token punctuation">(</span><span class="token function">inject</span><span class="token punctuation">(</span><span class="token constant">DOCUMENT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 注意这里是小写的inject的哦</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接下来我们从最简单的 addTag() 方法开始分析。</p> <h4 id="addtag-2"><a href="#addtag-2" aria-hidden="true" class="header-anchor">#</a> addTag()</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">addTag</span><span class="token punctuation">(</span>tag<span class="token punctuation">:</span> MetaDefinition<span class="token punctuation">,</span> forceCreation<span class="token punctuation">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HTMLMetaElement<span class="token operator">|</span><span class="token keyword">null</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getOrCreateElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> forceCreation<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这时我们知道其实在 addTag() 方法内部，最终是调用内部的私有方法  <code>_getOrCreateElement()</code>  来执行具体操作。_getOrCreateElement() 方法的具体实现如下：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">private</span> <span class="token function">_getOrCreateElement</span><span class="token punctuation">(</span>meta<span class="token punctuation">:</span> MetaDefinition<span class="token punctuation">,</span> forceCreation<span class="token punctuation">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      HTMLMetaElement <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>forceCreation<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 非强制模式</span>
      <span class="token keyword">const</span> selector<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_parseSelector</span><span class="token punctuation">(</span>meta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 解析选择器</span>
      <span class="token keyword">const</span> elem<span class="token punctuation">:</span> HTMLMetaElement <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTag</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span> <span class="token operator">!</span><span class="token punctuation">;</span> <span class="token comment">// 获取选择器匹配的Meta元素</span>
      <span class="token comment">// It's allowed to have multiple elements with the same name so it's not enough to</span>
      <span class="token comment">// just check that element with the same name already present on the page. </span>
      <span class="token comment">// We also need to check if element has tag attributes</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>elem <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_containsAttributes</span><span class="token punctuation">(</span>meta<span class="token punctuation">,</span> elem<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> elem<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 调用Dom适配器的createElement()方法创建meta元素  </span>
    <span class="token keyword">const</span> element<span class="token punctuation">:</span> HTMLMetaElement <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_dom<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'meta'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLMetaElement<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_setMetaElementAttributes</span><span class="token punctuation">(</span>meta<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取head元素，添加新建的meta元素并返回该元素      </span>
    <span class="token keyword">const</span> head <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_dom<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_doc<span class="token punctuation">,</span> <span class="token string">'head'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_dom<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 解析选择器</span>
<span class="token keyword">private</span> <span class="token function">_parseSelector</span><span class="token punctuation">(</span>tag<span class="token punctuation">:</span> MetaDefinition<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> attr<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> tag<span class="token punctuation">.</span>name <span class="token operator">?</span> <span class="token string">'name'</span> <span class="token punctuation">:</span> <span class="token string">'property'</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>attr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token punctuation">[</span>attr<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 设置Meta元素的属性</span>
<span class="token keyword">private</span> <span class="token function">_setMetaElementAttributes</span><span class="token punctuation">(</span>tag<span class="token punctuation">:</span> MetaDefinition<span class="token punctuation">,</span> el<span class="token punctuation">:</span> HTMLMetaElement<span class="token punctuation">)</span><span class="token punctuation">:</span> 
   HTMLMetaElement <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>prop<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
      <span class="token keyword">this</span><span class="token punctuation">.</span>_dom<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> tag<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> el<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>简单分析完 addTag()，我们再来看一下与它对应的 getTag() 方法。</p> <h4 id="gettag-2"><a href="#gettag-2" aria-hidden="true" class="header-anchor">#</a> getTag()</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">getTag</span><span class="token punctuation">(</span>attrSelector<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HTMLMetaElement<span class="token operator">|</span><span class="token keyword">null</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>attrSelector<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> 
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_dom<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_doc<span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`meta[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>attrSelector<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]`</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>该方法内部的实现也很简单，就是通过 DOM 适配器的 querySelector API  来实现元素匹配。对于前面的示例来说：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code> <span class="token keyword">let</span> metaEl<span class="token punctuation">:</span> HTMLMetaElement <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">getTag</span><span class="token punctuation">(</span><span class="token string">'name=&quot;keywords&quot;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>内部会转换为：</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_dom<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_doc<span class="token punctuation">,</span> <span class="token string">&quot;meta[name='keywords')&quot;</span> <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><p>新增和查询的方法介绍完，我们来继续分析一下 updateTag() 方法。</p> <h4 id="updatetag-2"><a href="#updatetag-2" aria-hidden="true" class="header-anchor">#</a> updateTag()</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">updateTag</span><span class="token punctuation">(</span>tag<span class="token punctuation">:</span> MetaDefinition<span class="token punctuation">,</span> selector<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HTMLMetaElement<span class="token operator">|</span><span class="token keyword">null</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tag<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    selector <span class="token operator">=</span> selector <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_parseSelector</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 解析选择器</span>
    <span class="token keyword">const</span> meta<span class="token punctuation">:</span> HTMLMetaElement <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTag</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span> <span class="token operator">!</span><span class="token punctuation">;</span> <span class="token comment">// 获取选择器对应的 Meta 元素</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 若已存在，则更新对应的属性</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_setMetaElementAttributes</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> meta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getOrCreateElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 否则在force模式下，创建 Meta 元素</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最后再来看一下 removeTag() 方法，顾名思义就是用来移除指定的 Meta 元素。</p> <h4 id="removetag-2"><a href="#removetag-2" aria-hidden="true" class="header-anchor">#</a> removeTag()</h4> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">removeTag</span><span class="token punctuation">(</span>attrSelector<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span> 
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeTagElement</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getTag</span><span class="token punctuation">(</span>attrSelector<span class="token punctuation">)</span> <span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">removeTagElement</span><span class="token punctuation">(</span>meta<span class="token punctuation">:</span> HTMLMetaElement<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>meta<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_dom<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>meta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="参考资源"><a href="#参考资源" aria-hidden="true" class="header-anchor">#</a> 参考资源</h3> <ul><li><a href="https://segmentfault.com/a/1190000004279791" target="_blank" rel="noopener noreferrer">HTML meta标签总结与属性使用介绍<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/angular-god-road/assets/js/35.284fb844.js" defer></script><script src="/angular-god-road/assets/js/app.4eaf616f.js" defer></script>
  </body>
</html>
